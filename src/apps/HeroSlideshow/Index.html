

{#if heroes === null}
  <p>loading...</p>
{:else}
  <div class="slideshow">
    <ul>
      <HeroDetails {hero} />
      
    </ul>
  </div>
{/if}

<style>
  ul {
    width: 100%;
    list-style: none;
    margin: 0 0;
    padding: 0 0;
    overflow: hidden;
  }
  
  .hero {
    display: block;
  }
</style>
<script>

  import HeroDetails from "components/HeroDetails.html";

  import opendota from "helpers/opendota";
  opendota.getHeroes().then(heroes => console.log(heroes));
  
  export default {
    
    oncreate() {
      let that = this;
      const { heroIndex } = this.get();
      opendota.getHeroes().then(heroes => {
        let hero = heroes[heroIndex];
        that.set({ heroes, heroIndex, hero })
        that.interval();
        
      });
    },
    
    data() {
      return {
        heroes: null,
        heroIndex: 0,
        timerID: null,
      }
    },
    
    methods: {
      
      interval() {
        const delay = 5000;
        let that= this;
        let { heroIndex, heroes } = this.get();
        
        let timerID = window.setTimeout(() => {
          heroIndex++;
          
          if (heroIndex >= heroes.length) heroIndex = 0;
          
          let hero = heroes[heroIndex];
          that.set({ heroIndex, hero });
          that.interval();
        }, delay);
        
        this.set({timerID})
        
      },
      
      stop() {
        let { timerID } = this.get();
        window.clearTimeout(timerID);
      }
      
    },
    
    components: { HeroDetails, },
  }
  
</script>